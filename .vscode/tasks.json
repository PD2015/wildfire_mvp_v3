{
  "version": "2.0.0",
  "tasks": [
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // PRE-COMMIT & QUALITY CHECKS
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    {
      "label": "ğŸ§ª Pre-commit: Full Check",
      "type": "shell",
      "command": "dart format . && flutter analyze && flutter test",
      "group": {
        "kind": "test",
        "isDefault": true
      },
      "presentation": {
        "reveal": "always",
        "panel": "dedicated"
      },
      "problemMatcher": ["$dart-analyze", "$dart-test"]
    },
    {
      "label": "ğŸ›ï¸ Constitutional Gates (C1-C5)",
      "type": "shell",
      "command": "./scripts/constitution-gates.sh",
      "presentation": {
        "reveal": "always",
        "panel": "dedicated",
        "clear": true
      }
    },
    {
      "label": "ğŸ” Format Check Only",
      "type": "shell",
      "command": "dart format --output=none --set-exit-if-changed .",
      "problemMatcher": []
    },
    {
      "label": "âœ¨ Format Code (Apply)",
      "type": "shell",
      "command": "dart format lib/ test/",
      "problemMatcher": []
    },
    {
      "label": "ğŸ”¬ Analyze Only",
      "type": "shell",
      "command": "flutter analyze --no-fatal-infos",
      "problemMatcher": ["$dart-analyze"]
    },

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // TESTING WORKFLOWS
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    {
      "label": "ğŸ§ª Test: All",
      "type": "shell",
      "command": "flutter test --reporter expanded",
      "group": "test",
      "problemMatcher": ["$dart-test"]
    },
    {
      "label": "ğŸ§ª Test: Unit Only",
      "type": "shell",
      "command": "flutter test test/unit/ --reporter expanded",
      "problemMatcher": ["$dart-test"]
    },
    {
      "label": "ğŸ§ª Test: Integration Only",
      "type": "shell",
      "command": "flutter test test/integration/ --reporter expanded",
      "problemMatcher": ["$dart-test"]
    },
    {
      "label": "ğŸ§ª Test: Widget Only",
      "type": "shell",
      "command": "flutter test test/widget/ --reporter expanded",
      "problemMatcher": ["$dart-test"]
    },
    {
      "label": "ğŸŒ Test: Web Platform",
      "type": "shell",
      "command": "flutter test test/unit/ --platform=chrome && flutter test test/integration/ --platform=chrome",
      "problemMatcher": ["$dart-test"]
    },
    {
      "label": "ğŸ“Š Test: With Coverage",
      "type": "shell",
      "command": "flutter test --coverage && genhtml coverage/lcov.info -o coverage/html",
      "problemMatcher": ["$dart-test"]
    },

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // PLATFORM RUNS (Development)
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    {
      "label": "ğŸŒ Run: Web (with API keys)",
      "type": "shell",
      "command": "./scripts/run_web.sh",
      "isBackground": true,
      "presentation": {
        "reveal": "always",
        "panel": "dedicated"
      },
      "problemMatcher": {
        "pattern": {
          "regexp": "^.*$",
          "file": 1,
          "line": 1,
          "column": 1,
          "message": 1
        },
        "background": {
          "activeOnStart": true,
          "beginsPattern": "^.*Launching.*",
          "endsPattern": "^.*Application finished.*"
        }
      }
    },
    {
      "label": "ğŸ Run: macOS (with API keys)",
      "type": "shell",
      "command": "flutter run -d macos --dart-define-from-file=env/dev.env.json",
      "isBackground": true,
      "problemMatcher": []
    },
    {
      "label": "ğŸ“± Run: iOS Simulator (with API keys)",
      "type": "shell",
      "command": "./scripts/run_ios.sh",
      "isBackground": true,
      "problemMatcher": []
    },
    {
      "label": "ğŸ¤– Run: Android Emulator",
      "type": "shell",
      "command": "./scripts/run_android.sh",
      "isBackground": true,
      "problemMatcher": []
    },
    {
      "label": "ğŸ“Š DevTools: Start Server",
      "type": "shell",
      "command": "dart devtools",
      "isBackground": true,
      "presentation": {
        "reveal": "always",
        "panel": "new",
        "showReuseMessage": false
      },
      "problemMatcher": {
        "pattern": {
          "regexp": "^.*$"
        },
        "background": {
          "activeOnStart": true,
          "beginsPattern": "^.*Starting.*",
          "endsPattern": "^.*Serving DevTools at.*"
        }
      }
    },
    {
      "label": "ğŸŒğŸ” Run: Web + DevTools",
      "dependsOn": [
        "ğŸ“Š DevTools: Start Server",
        "ğŸŒ Run: Web (with API keys)"
      ],
      "dependsOrder": "parallel",
      "presentation": {
        "reveal": "always"
      },
      "problemMatcher": []
    },

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // BUILD TASKS
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    {
      "label": "ğŸ”¨ Build: Web (CI mode with API key)",
      "type": "shell",
      "command": "export MAPS_API_KEY_WEB=$(jq -r .GOOGLE_MAPS_API_KEY_WEB env/dev.env.json) && ./scripts/build_web_ci.sh",
      "presentation": {
        "reveal": "always",
        "panel": "dedicated"
      },
      "problemMatcher": []
    },
    {
      "label": "ğŸ”¨ Build: Web (Release)",
      "type": "shell",
      "command": "flutter build web --release --dart-define-from-file=env/dev.env.json",
      "presentation": {
        "reveal": "always"
      },
      "problemMatcher": []
    },
    {
      "label": "ğŸ”¨ Build: iOS",
      "type": "shell",
      "command": "flutter build ios --release --dart-define-from-file=env/dev.env.json",
      "problemMatcher": []
    },
    {
      "label": "ğŸ”¨ Build: Android APK",
      "type": "shell",
      "command": "flutter build apk --release --dart-define-from-file=env/dev.env.json",
      "problemMatcher": []
    },

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // GIT & DEPLOYMENT WORKFLOWS
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    {
      "label": "ğŸš€ CI: Check Latest Run",
      "type": "shell",
      "command": "gh run list --limit 5 --json databaseId,status,conclusion,headBranch,event,displayTitle",
      "presentation": {
        "reveal": "always",
        "panel": "shared"
      },
      "problemMatcher": []
    },
    {
      "label": "ğŸš€ CI: Watch Current Run",
      "type": "shell",
      "command": "gh run watch",
      "isBackground": true,
      "problemMatcher": []
    },
    {
      "label": "ğŸš€ Deploy: Check Staging Status",
      "type": "shell",
      "command": "gh run list --branch=staging --limit 1 && echo '\nğŸ”— Staging URL: https://wildfire-app-e11f8-staging.web.app'",
      "problemMatcher": []
    },
    {
      "label": "ğŸ“¦ PR: Create to Staging",
      "type": "shell",
      "command": "gh pr create --base staging --title '${input:prTitle}' --body '${input:prBody}'",
      "problemMatcher": []
    },
    {
      "label": "ğŸ“¦ PR: View Current",
      "type": "shell",
      "command": "gh pr view --web",
      "problemMatcher": []
    },

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // SECURITY & API KEY CHECKS
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    {
      "label": "ğŸ”’ Security: Check for Leaked Keys",
      "type": "shell",
      "command": "grep -rE 'AIza[A-Za-z0-9_-]{35}' --exclude-dir=node_modules --exclude-dir=build . || echo 'âœ… No API keys found in code'",
      "presentation": {
        "reveal": "always"
      },
      "problemMatcher": []
    },
    {
      "label": "ğŸ”’ Security: Run Gitleaks",
      "type": "shell",
      "command": "docker run --rm -v ${workspaceFolder}:/repo zricethezav/gitleaks:latest detect --source=/repo --verbose --no-git",
      "problemMatcher": []
    },
    {
      "label": "ğŸ”‘ Verify: Environment Files",
      "type": "shell",
      "command": "test -f env/dev.env.json && echo 'âœ… dev.env.json exists' || echo 'âŒ Missing env/dev.env.json'; test -f env/prod.env.json && echo 'âœ… prod.env.json exists' || echo 'âš ï¸  Missing env/prod.env.json (optional for local dev)'",
      "problemMatcher": []
    },

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // PROJECT MAINTENANCE
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    {
      "label": "ğŸ§¹ Clean: Build Artifacts",
      "type": "shell",
      "command": "flutter clean && flutter pub get",
      "presentation": {
        "reveal": "always"
      },
      "problemMatcher": []
    },
    {
      "label": "ğŸ“š Docs: Health Check",
      "type": "shell",
      "command": "./scripts/docs-health-check.sh",
      "problemMatcher": []
    },
    {
      "label": "ğŸ¨ Color Guard: Verify No Ad-Hoc Colors",
      "type": "shell",
      "command": "./scripts/verify_no_adhoc_colors.sh",
      "problemMatcher": []
    },
    {
      "label": "ğŸ“¦ Dependencies: Update",
      "type": "shell",
      "command": "flutter pub upgrade && flutter pub outdated",
      "problemMatcher": []
    },

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // FEATURE DEVELOPMENT (Spec-Driven)
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    {
      "label": "ğŸ“ Feature: Update Agent Context",
      "type": "shell",
      "command": ".specify/scripts/bash/update-agent-context.sh copilot",
      "presentation": {
        "reveal": "always"
      },
      "problemMatcher": []
    },
    {
      "label": "ğŸ“ Feature: Check Prerequisites",
      "type": "shell",
      "command": ".specify/scripts/bash/check-prerequisites.sh",
      "problemMatcher": []
    },

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // COMPOSITE WORKFLOWS (chains multiple tasks)
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    {
      "label": "ğŸš€ Deploy Prep: Full Pipeline",
      "dependsOn": [
        "ğŸ§ª Pre-commit: Full Check",
        "ğŸ”’ Security: Check for Leaked Keys",
        "ğŸ”¨ Build: Web (CI mode with API key)"
      ],
      "dependsOrder": "sequence",
      "presentation": {
        "reveal": "always",
        "panel": "dedicated"
      }
    }
  ],

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // INPUT PROMPTS (for interactive tasks)
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  "inputs": [
    {
      "id": "prTitle",
      "type": "promptString",
      "description": "Pull Request Title",
      "default": "feat: "
    },
    {
      "id": "prBody",
      "type": "promptString",
      "description": "Pull Request Description",
      "default": "Description of changes"
    }
  ]
}
